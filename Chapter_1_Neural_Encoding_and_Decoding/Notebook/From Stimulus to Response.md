# From Stimulus to Response
Expression for neural response

## Expression Summary

**Neural Response Function:**
\langle \rho(t) \rangle = \frac{1}{m}\sum_{j=1}^{m}\rho^j(t)


**Time-dependent Firing Rate**
r(t) = \frac{1}{\Delta t}\int_t^{t+\Delta t} \langle \rho(\tau) \rangle \cdot d\tau \quad \Delta t \rightarrow 0


relationship:
\int h(\tau) \cdot \langle \rho(\tau) \rangle \cdot \tau = \int h(\tau) \cdot \r(\tau) \cdot \tau \quad \Delta t \rightarrow 0 

**Spike-count Rate**

Firing rate per trial over a long time period(any time period or entire trial duration)

r = \frac{n}{T} = \frac{1}{T} \cdot \int_{0}^{T} \rho(\tau) \cdot d\tau

**Average Firing Rate**

Average firing rate over a long time period(any time period or entire trial duration)

\langle r \rangle = \frac{r}{m} = \frac{ \rangle n \langle}{T} = \frac{1}{T} \int_{0}^{T} \langle \rho(t) \rangle \cdot dt = \frac{1}{T} \int_{0}^{T} r(t) \cdot dt 



Presupposition:
(1)Action potential can vary in duration, amplitude and shape. In the following presentation, they are treated as **identical stereotyped event**.
(2) We ignore the brief duration of an action potential(about 1 ms). Occuration of an action potential is present as a time point **t_i**. 


## Dirak Delta Function:
### Expression:
\delta(x) =  \lim_{T \to 0} f(x) = 5
\begin{cases}
\frac{1}{T} &  t\in[0, T]\\
0 & otherwise
\end{cases}

<div align=center>
	<img width="500" height="285" src="Dirak Function fig.png"/>
</div>

### Properties:
(1)
f(a) = \int_{-Inf}^{Inf} f(x) \cdot \delta(x-a) \cdot dx

(2)
f(x) = \int f(t) \cdot \delta(t-x) \cdot dt
Provided the integral surround the point t.
If not, the integral equals to 0

## Neural response function:

### Expression:
Superimpose many Dirac Functions, each refers to one spike:
\rho(t) = \sum_{i=1}^{n} \delta(t-t_i) \quad t\in[0, T]

### Properties
(1)
\sum_{i=1}^{n}f(t_i) = \int_{-Inf}^{Inf} f(t) \cdot \rho(t) \cdot dt

(2)
\sum_{i=1}^{n}f(t-t_i) = \int_{-Inf}^{Inf} f(x) \cdot \rho(t-x) \cdot dx


## Time dependent firing rate
> "Because the sequence of action potentials generated by the **same** stimulus could vary from trial to trial, neural responses are typically treated statistically or probablistically."

### Expression
That is to say, to get neural responses for a given stimulus, 
1. Repeat inputing the same stimulus **for several trials**; 

Let's say we did **m** trials in total.

> **!Caution!**
> (1) Neural response could show adaptation when receiving the repeated stimulus.
> (2) Single Neural response within neural network receive stimulus both from botton-up input and divisive normalizing input(from other neurons within the network) <sub>[2]</sub>

2. Gather action potential sequences for each trial, response time from 0 to T;

For the i<sub>th</sub> trial, the neural response function is 

\rho^j(t) = \sum_{i=1}^{n} \delta(t-t^j_i) \quad t\in[0, T], \quad j=1,2,...,m

Symbol "<>" refers to averaging over trials.


3. Average all neural response functions over trials

**Trial-averaged neural response function**

\langle \rho(t) \rangle = \frac{1}{m}\sum_{j=1}^{m}\rho^j(t)

4. Count spike rate in short \delta t inteval;

5. average **firing rate** at time t over \delta t inteval:

**time-dependent firing rate**

r(t) = \frac{1}{\Delta t}\int_t^{t+\Delta t} \langle \rho(\tau) \rangle \cdot d\tau \quad \Delta t \rightarrow 0

> "In application, \delta t need to be big enough so there are sufficient number of spikes within \delta t intervals for r(t)"

r(t) and <\rho (t)> are of great similarity. r(t) is the averaged value of <\rho (t)> in [t, t+\delta t] interval. If \delta t is sufficiently big, while <\rho (t)> is in shape of great peaks, r(t) is a scalar shape. 

<div align=center>
	<img width="500" height="285" src="r(t)_rho(t).png"/>
</div>

In this case, r(t) could also be interpreted as density of neural response along time axis.

-------------------

For the total time range, the integral value of two function are equal:

\int \langle \rho(\tau) \rangle \cdot d\tau = \int \langle r(\tau) \rangle \cdot d\tau 

> "Because of the relationship between this fraction(\rho (t)) and the firing rate, we can
replace the trial-averaged neural response function with the Ãžring rate r(t) within any well-behaved integral,"

\int h(\tau) \cdot \langle \rho(\tau) \rangle \cdot \tau = \int h(\tau) \cdot \r(\tau) \cdot \tau \quad \Delta t \rightarrow 0 

If \delta t is too big, r(t) and <\rho(t)> will add sufficiently different contribution to h(t).

-----------------


# Reference:
*[1] Dayan P, Abbott L F. Theoretical neuroscience[M]. Cambridge, MA: MIT Press, 2001: 8-11*
*[2] Coen-Cagli R, Solomon S S. Relating divisive normalization to neuronal response variability[J]. Journal of Neuroscience, 2019, 39(37): 7344-7356.*
